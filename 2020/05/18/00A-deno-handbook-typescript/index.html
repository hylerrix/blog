<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Deno 入门手册：附大量 TypeScript 代码实例 - 韩亦乐的个人网站</title><meta description="原文地址：The Deno Handbook: A TypeScript Runtime Tutorial with Code Examples 原文作者：Flavio Copes 原文发布时间：2020-05-12 译者：hylerrix（韩亦乐）, Yunkou（寇云） 校对者：hylerrix（韩亦乐） 备注：本文遵循 freeCodeCamp 翻译规范，同时本文会收录在《Deno 钻研"><meta property="og:type" content="blog"><meta property="og:title" content="Deno 入门手册：附大量 TypeScript 代码实例"><meta property="og:url" content="https://hylerrix.github.io/blog/2020/05/18/00A-deno-handbook-typescript/"><meta property="og:site_name" content="韩亦乐的个人网站"><meta property="og:description" content="原文地址：The Deno Handbook: A TypeScript Runtime Tutorial with Code Examples 原文作者：Flavio Copes 原文发布时间：2020-05-12 译者：hylerrix（韩亦乐）, Yunkou（寇云） 校对者：hylerrix（韩亦乐） 备注：本文遵循 freeCodeCamp 翻译规范，同时本文会收录在《Deno 钻研"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108212-9cf6dc3e-0bc8-4194-8d77-f6dafc31dcc1.jpeg#align=left&amp;display=inline&amp;height=904&amp;margin=%5Bobject%20Object%5D&amp;originHeight=904&amp;originWidth=1706&amp;size=0&amp;status=done&amp;style=none&amp;width=1706"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108205-00f60477-b616-452d-a55e-44c96aa7044c.jpeg#align=left&amp;display=inline&amp;height=1080&amp;margin=%5Bobject%20Object%5D&amp;originHeight=1080&amp;originWidth=1964&amp;size=0&amp;status=done&amp;style=none&amp;width=1964"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108204-177538f5-f838-43d2-872d-7738a2e5ad74.jpeg#align=left&amp;display=inline&amp;height=678&amp;margin=%5Bobject%20Object%5D&amp;originHeight=678&amp;originWidth=1388&amp;size=0&amp;status=done&amp;style=none&amp;width=1388"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108212-88b3701c-858d-4d7a-9e68-e52c159d4eac.jpeg#align=left&amp;display=inline&amp;height=578&amp;margin=%5Bobject%20Object%5D&amp;originHeight=578&amp;originWidth=1908&amp;size=0&amp;status=done&amp;style=none&amp;width=1908"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108234-0283df4e-e0ba-4db9-85f8-af0d6ee9723e.jpeg#align=left&amp;display=inline&amp;height=487&amp;margin=%5Bobject%20Object%5D&amp;originHeight=487&amp;originWidth=752&amp;size=0&amp;status=done&amp;style=none&amp;width=752"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108318-25c83547-94e1-42a2-9352-a33bd30bbae9.jpeg#align=left&amp;display=inline&amp;height=564&amp;margin=%5Bobject%20Object%5D&amp;originHeight=564&amp;originWidth=1266&amp;size=0&amp;status=done&amp;style=none&amp;width=1266"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108160-002b0318-a8a9-4444-87fe-6608a25fe62a.jpeg#align=left&amp;display=inline&amp;height=778&amp;margin=%5Bobject%20Object%5D&amp;originHeight=778&amp;originWidth=1622&amp;size=0&amp;status=done&amp;style=none&amp;width=1622"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108280-40933589-9ba2-4337-a5b9-467534237714.jpeg#align=left&amp;display=inline&amp;height=578&amp;margin=%5Bobject%20Object%5D&amp;originHeight=578&amp;originWidth=1622&amp;size=0&amp;status=done&amp;style=none&amp;width=1622"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108587-ce37d813-3c3c-4aa5-8be2-9edeb4128efb.jpeg#align=left&amp;display=inline&amp;height=940&amp;margin=%5Bobject%20Object%5D&amp;originHeight=940&amp;originWidth=1375&amp;size=0&amp;status=done&amp;style=none&amp;width=1375"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108193-34529ea2-a542-4d14-911a-5cc9c2c0ae2a.jpeg#align=left&amp;display=inline&amp;height=751&amp;margin=%5Bobject%20Object%5D&amp;originHeight=751&amp;originWidth=1059&amp;size=0&amp;status=done&amp;style=none&amp;width=1059"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108258-3a5d47d0-1630-4950-907a-9dc14399ed1c.jpeg#align=left&amp;display=inline&amp;height=1014&amp;margin=%5Bobject%20Object%5D&amp;originHeight=1014&amp;originWidth=1266&amp;size=0&amp;status=done&amp;style=none&amp;width=1266"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108249-f25465bc-528c-44f8-91bf-a9cb5530258a.jpeg#align=left&amp;display=inline&amp;height=364&amp;margin=%5Bobject%20Object%5D&amp;originHeight=364&amp;originWidth=1266&amp;size=0&amp;status=done&amp;style=none&amp;width=1266"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108284-f40a4a1b-361a-4d66-8fc6-3565b5f78df3.jpeg#align=left&amp;display=inline&amp;height=264&amp;margin=%5Bobject%20Object%5D&amp;originHeight=264&amp;originWidth=850&amp;size=0&amp;status=done&amp;style=none&amp;width=850"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108404-f8d8f085-033f-4d0d-8ceb-26be08149324.jpeg#align=left&amp;display=inline&amp;height=487&amp;margin=%5Bobject%20Object%5D&amp;originHeight=487&amp;originWidth=908&amp;size=0&amp;status=done&amp;style=none&amp;width=908"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108254-49bb0133-c6c2-4ebb-82e9-b0240541f0e0.jpeg#align=left&amp;display=inline&amp;height=751&amp;margin=%5Bobject%20Object%5D&amp;originHeight=751&amp;originWidth=1059&amp;size=0&amp;status=done&amp;style=none&amp;width=1059"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108211-4239256a-5731-471c-b8ad-496b5a1b308a.jpeg#align=left&amp;display=inline&amp;height=489&amp;margin=%5Bobject%20Object%5D&amp;originHeight=489&amp;originWidth=967&amp;size=0&amp;status=done&amp;style=none&amp;width=967"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108327-f72d7fd6-6971-4799-a9f0-19f07f536cd4.jpeg#align=left&amp;display=inline&amp;height=439&amp;margin=%5Bobject%20Object%5D&amp;originHeight=439&amp;originWidth=967&amp;size=0&amp;status=done&amp;style=none&amp;width=967"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108275-215875c2-13ed-4ac7-b58b-22a2e21b6805.jpeg#align=left&amp;display=inline&amp;height=1123&amp;margin=%5Bobject%20Object%5D&amp;originHeight=1123&amp;originWidth=923&amp;size=0&amp;status=done&amp;style=none&amp;width=923"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108253-c730a830-ac38-4909-a7e1-fb0895cd45e9.jpeg#align=left&amp;display=inline&amp;height=339&amp;margin=%5Bobject%20Object%5D&amp;originHeight=339&amp;originWidth=1084&amp;size=0&amp;status=done&amp;style=none&amp;width=1084"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108268-7efd6854-4555-47eb-afa1-9e2c853bd2c0.jpeg#align=left&amp;display=inline&amp;height=624&amp;margin=%5Bobject%20Object%5D&amp;originHeight=624&amp;originWidth=879&amp;size=0&amp;status=done&amp;style=none&amp;width=879"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108264-40e48063-e125-4d38-bdbf-269d8ed0b608.jpeg#align=left&amp;display=inline&amp;height=624&amp;margin=%5Bobject%20Object%5D&amp;originHeight=624&amp;originWidth=879&amp;size=0&amp;status=done&amp;style=none&amp;width=879"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108248-a5198b2e-db87-4370-aa93-e9d1be6eb73e.jpeg#align=left&amp;display=inline&amp;height=624&amp;margin=%5Bobject%20Object%5D&amp;originHeight=624&amp;originWidth=879&amp;size=0&amp;status=done&amp;style=none&amp;width=879"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108243-5c436797-023f-42c3-a47c-02c97d026a64.jpeg#align=left&amp;display=inline&amp;height=624&amp;margin=%5Bobject%20Object%5D&amp;originHeight=624&amp;originWidth=879&amp;size=0&amp;status=done&amp;style=none&amp;width=879"><meta property="og:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108280-d05de626-aa2f-45f2-84f9-4fbe37e76a33.jpeg#align=left&amp;display=inline&amp;height=624&amp;margin=%5Bobject%20Object%5D&amp;originHeight=624&amp;originWidth=879&amp;size=0&amp;status=done&amp;style=none&amp;width=879"><meta property="article:published_time" content="2020-05-18T00:00:00.000Z"><meta property="article:modified_time" content="2020-08-08T00:29:48.247Z"><meta property="article:author" content="Hylerrix Han"><meta property="article:tag" content="Deno"><meta property="article:tag" content="TypeScript"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108212-9cf6dc3e-0bc8-4194-8d77-f6dafc31dcc1.jpeg#align=left&amp;display=inline&amp;height=904&amp;margin=%5Bobject%20Object%5D&amp;originHeight=904&amp;originWidth=1706&amp;size=0&amp;status=done&amp;style=none&amp;width=1706"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hylerrix.github.io/blog/2020/05/18/00A-deno-handbook-typescript/"},"headline":"韩亦乐的个人网站","image":[],"datePublished":"2020-05-18T00:00:00.000Z","dateModified":"2020-08-08T00:29:48.247Z","author":{"@type":"Person","name":"Hylerrix Han"},"description":"原文地址：The Deno Handbook: A TypeScript Runtime Tutorial with Code Examples 原文作者：Flavio Copes 原文发布时间：2020-05-12 译者：hylerrix（韩亦乐）, Yunkou（寇云） 校对者：hylerrix（韩亦乐） 备注：本文遵循 freeCodeCamp 翻译规范，同时本文会收录在《Deno 钻研"}</script><link rel="canonical" href="https://hylerrix.github.io/blog/2020/05/18/00A-deno-handbook-typescript/"><link rel="icon" href="/blog/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blog/"><img src="/blog/img/logo.svg" alt="韩亦乐的个人网站" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blog/">Home</a><a class="navbar-item" href="/blog/archives">Archives</a><a class="navbar-item" href="/blog/categories">Categories</a><a class="navbar-item" href="/blog/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hylerrix"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-05-18T00:00:00.000Z" title="2020-05-18T00:00:00.000Z">2020-05-18</time><span class="level-item"><a class="link-muted" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/">Deno 钻研之术</a></span><span class="level-item">an hour read (About 8711 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Deno 入门手册：附大量 TypeScript 代码实例</h1><div class="content"><blockquote>
<ul>
<li>原文地址：<a href="https://www.freecodecamp.org/news/the-deno-handbook/">The Deno Handbook: A TypeScript Runtime Tutorial with Code Examples</a></li>
<li>原文作者：Flavio Copes</li>
<li>原文发布时间：2020-05-12</li>
<li>译者：<a href="https://github.com/hylerrix">hylerrix</a>（韩亦乐）, <a href="https://github.com/yunkou">Yunkou</a>（寇云）</li>
<li>校对者：<a href="https://github.com/hylerrix">hylerrix</a>（韩亦乐）</li>
<li>备注：本文遵循 <a href="https://github.com/freeCodeCamp/news-translation">freeCodeCamp 翻译规范</a>，同时本文会收录在<a href="https://github.com/hylerrix/deno-tutorial">《Deno 钻研之术》</a>的翻译篇中。</li>
<li>备注：非营利组织 freeCodeCamp.org 自 2014 年成立以来，以“帮助人们免费学习编程”为使命，创建了大量免费的编程教程，包括交互式课程、视频课程、文章等。线下开发者社区遍布 160 多个国家、2000 多个城市。我们正在帮助全球数百万人学习编程，希望让世界上每个人都有机会获得免费的优质的编程教育资源，成为开发者或者运用编程去解决问题。搜索关注微信公众号 “freeCodeCamp”，可了解更多信息。</li>
</ul>
</blockquote>
<a id="more"></a>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108212-9cf6dc3e-0bc8-4194-8d77-f6dafc31dcc1.jpeg#align=left&display=inline&height=904&margin=%5Bobject%20Object%5D&originHeight=904&originWidth=1706&size=0&status=done&style=none&width=1706" alt=""></p>
<p>我每周都在探索新的项目，很少会有一个像 <a href="https://deno.land/">Deno</a> 这样的项目让我如此着迷。</p>
<p>在本手册中我想要让你快速入手 Deno。我会将其与 Node.js 进行对比，然后助力你在 Deno 上搭建第一个 REST API Demo。</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li>什么是 Deno？</li>
<li>为什么是 Deno？为什么是现在？</li>
<li>你应该学习 Deno 吗？</li>
<li>Deno 将取代 Node.js 吗？</li>
<li>一流的 TypeScript 支持</li>
<li>与 Node.js 的异同</li>
<li>不再有包管理器</li>
<li>安装 Deno</li>
<li>Deno 命令</li>
<li>你的第一个 Deno 应用</li>
<li>Deno 代码实例</li>
<li>你的第一个 Deno 应用（深入版）</li>
<li>Deno 安全沙箱（Sandbox）</li>
<li>格式化代码</li>
<li>标准库</li>
<li>另一个 Deno 示例</li>
<li>Deno 是否有 Express/Hapi/Koa/*？</li>
<li>示例：使用 Oak 构建 REST API</li>
<li>更多内容</li>
<li>花絮</li>
<li>结语</li>
</ol>
<p>此外，<a href="https://flaviocopes.com/page/deno-handbook/">你可以在此处获取此 Deno 手册的 PDF / ePub / Mobi 版本。</a></p>
<h2 id="什么是-Deno？"><a href="#什么是-Deno？" class="headerlink" title="什么是 Deno？"></a>什么是 Deno？</h2><p>如果你熟悉流行的服务器端 JavaScript 运行时 Node.js，那么 Deno 就像 Node.js 一样，但却在很多方面都得到了深刻改善的全新 JavaScript / TypeScript 运行时。</p>
<p>让我们从 Deno 的功能列表快速了解：</p>
<ul>
<li>Deno 基于最新的 JavaScript 语言；</li>
<li>Deno 具有覆盖面广泛的标准库；</li>
<li>Deno 以 TypeScript 为核心，配以更多独特的方式从而带来了巨大的优势，其中包括一流的 TypeScript 支持（Deno 自动编译 TypeScript 而无需你单独编译）；</li>
<li>Deno 大力拥抱 ES 模块标准；</li>
<li>Deno 没有包管理器；</li>
<li>Deno 具有一流的 <code>await</code> 语法支持；</li>
<li>Deno 内置测试工具；</li>
<li>Deno 旨在尽可能地与浏览器兼容，例如通过提供内置对象 <code>fetch</code> 和全局 <code>window</code> 对象。</li>
</ul>
<p>我们将在本手册中展开探索所有上述功能。</p>
<p>在你实战完 Deno 并了解它独特的功能魅力后，Node.js 或许会看起来有些过时。</p>
<p>特别是因为 Node.js 的 API 是基于回调机制的，因为 Node.js 是在 Promise 和 Async / Await 定义在标准之前编写的。Node.js 中无法对此机制进行全新的更改，因为此类更改将产生“毁灭性”的影响。因此，在 Node.js 中我们陷入了回调大量 API 的困境。</p>
<p>Node.js 的确很棒，并在可见的未来将继续成为 JavaScript 世界中事实上的标准。但我认为我们将逐渐看到 Deno 会因其一流的 TypeScript 支持和其内置的、覆盖面广泛的现代标准库而越来越被重视和采用。</p>
<p>由于没有向后兼容性的历史原因，Deno 将可以承担起所有使用现代 Web 技术编写的工程建设。但目前的现实是，我们也无法保证十年之内 Deno 不会发生像 Node.js 同样的事情，并且不会出现一项新技术代替 Deno。</p>
<h2 id="为什么是-Deno？为什么是现在？"><a href="#为什么是-Deno？为什么是现在？" class="headerlink" title="为什么是 Deno？为什么是现在？"></a>为什么是 Deno？为什么是现在？</h2><p>大约 2 年前，Node.js 的创建者 Ryan Dahl 在 JSConf EU 上首次介绍了 Deno。观看<a href="https://www.youtube.com/watch?v=M3BM9TB-8yA">当时的演讲视频</a>会非常有趣。如果你平时在大量接触 Node.js 和 JavaScript，这个视频请不要错过。</p>
<p>每个项目经理都必须下发决定。Ryan 回看 Node.js 中的一些早期设计依然感觉十分遗憾。此外，在 ES6/2016/2017 等持续发展中的标准加持下，如今的 JavaScript 与 2009 年 Node.js 创立时的 JavaScript 已经大不相同。</p>
<p>因此，他开启了一个全新项目，从而创建出服务器端的第二代 JavaScript 运行时。</p>
<p>新生的技术需要大量时间才能成熟，这正是我现在撰写本手册而不是两年前就开始撰写的原因。如今，第一个正式稳定的 Deno v1.0 版本终于指日可待（不出意外的话，v1.0 会在 2020 年 5 月 13 日发布）。</p>
<blockquote>
<p>译者注：翻译本手册时 Deno 1.0 已经发布。</p>
</blockquote>
<p>1.0 看起来仅仅是个数字，但在社区约定下，意味着直到 Deno 2.0 前 Deno 都不会有太多重大的破坏性改变——这很重要，因为你终于可以安心学习 Deno 当前的稳定版本了。</p>
<h2 id="你应该学习-Deno-吗？"><a href="#你应该学习-Deno-吗？" class="headerlink" title="你应该学习 Deno 吗？"></a>你应该学习 Deno 吗？</h2><p>这并不那么容易回答。</p>
<p>学习像 Deno 这样全新的知识需要不少的前期技术沉淀。我的建议是：如果你现在才开始在服务器端使用 JavaScript 编程，并且你还不了解 Node.js，更没有任何 TypeScript 应用开发经验——那么请从 Node.js 学起。</p>
<p>毕竟用通俗观点来说，没有人会在如今因为选择学习 Node.js 而被解雇。</p>
<p>但如果你喜欢 TypeScript、也不想让项目中依赖无比庞大的 NPM 软件包、还想要随时随地使用 <code>await</code> 等语法，那么你可能真的需要 Deno。</p>
<h2 id="Deno-将取代-Node-js-吗？"><a href="#Deno-将取代-Node-js-吗？" class="headerlink" title="Deno 将取代 Node.js 吗？"></a>Deno 将取代 Node.js 吗？</h2><p>不能。Node.js 的生态已经十分庞大和完善，获得了数以万计的优秀技术支持，将能再战数十年。</p>
<h2 id="一流的-TypeScript-支持"><a href="#一流的-TypeScript-支持" class="headerlink" title="一流的 TypeScript 支持"></a>一流的 TypeScript 支持</h2><p>Deno 基于 Rust 和 TypeScript 这两种今天正在迅速发展的语言编写。</p>
<p>这意味着，即使我们可能选择编写纯 JavaScript 代码来运行在基于 TypeScript 语言编写的 Deno 上，我们也可以获得 TypeScript 的很多好处。</p>
<p>使用 Deno 运行 TypeScript 代码无需任何手动编译——Deno 会自动为你执行此步骤。</p>
<p>你不必非得在 Deno 上编写 TypeScript 代码，但是 Deno 因其核心由 TypeScript 语言编写的如下相关背景是不容忽视的：</p>
<p>首先，越来越多的 JavaScript 程序员开始喜欢上了 TypeScript 语言。</p>
<p>其次，你使用的工具可以方便地推断出许多有关用 TypeScript 语言编写的软件的信息，例如 Deno。</p>
<p>因此，当我们在 VS Code（紧密集成 TypeScript 的编辑器）上的编码环节就能及时地体会到类型检查和高级<a href="https://code.visualstudio.com/docs/editor/intellisense">智能感知（IntelliSense）</a>功能带来的好处。换句话说，编辑器可以以非常有用的方式来帮助我们了解 TypeScript 项目。</p>
<h2 id="与-Node-js-的异同"><a href="#与-Node-js-的异同" class="headerlink" title="与 Node.js 的异同"></a>与 Node.js 的异同</h2><p>由于 Deno 从某种角度来讲是 Node.js 的替代品，因此直接比较两者的异同对我们的理解会很有帮助。</p>
<p>相似之处：</p>
<ul>
<li>两者都是基于 <a href="https://flaviocopes.com/v8/">V8 引擎</a>开发的；</li>
<li>两者都非常适合在服务器端上编写 JavaScript 应用。</li>
</ul>
<p>差异之处：</p>
<ul>
<li>Node.js 用 C++ 和 JavaScript 语言编写。Deno 用 Rust 和 TypeScript 语言编写。</li>
<li>Node.js 有一个官方的软件包管理器，称为 NPM。Deno 不会有，而会允许你从 URL 导入任何 ES 模块。</li>
<li>Node.js 使用 CommonJS 模块语法导入软件包。Deno 使用 ES 标准模块导入。</li>
<li>Deno 在其所有 API 和标准库中都使用现代 ECMAScript 功能，而 Node.js 使用基于回调的标准库，并且没有计划对其进行升级。</li>
<li>Deno 通过权限控制提供了一个安全的沙箱环境，程序只能访问由用户设置为可执行标志的文件。Node.js 程序可以直接访问用户足以访问的任何内容。</li>
<li>Deno 长期以来一直在探索将程序编译成单个可执行文件的可能性，从而使得该可执行文件可以在没有外部依赖项（例如 Go）的情况下运行，但这并<a href="https://github.com/denoland/deno/issues/986">不是一件容易的事</a>，如果做得到，将会成为更有话语权的游戏规则改变者。</li>
</ul>
<h2 id="没有包依赖管理器"><a href="#没有包依赖管理器" class="headerlink" title="没有包依赖管理器"></a>没有包依赖管理器</h2><p>没有像 NPM 一样的程序包管理器并且大量依靠 URL 来承载和导入程序包是有利有弊的。但我真的很喜欢这个特性：它将会非常灵活，我们可以直接创建软件包而无需在 NPM 这样的存储库中发布它们。</p>
<p>虽然还没有官方的消息，但我认为 Deno 下的某种软件包管理器将会出现。</p>
<p>与此同时，Deno 网站为第三方软件包提供代码托管服务（并帮助其通过 URL 分发）：详见 <a href="https://deno.land/x/">https://deno.land/x/</a>。</p>
<h2 id="安装-Deno"><a href="#安装-Deno" class="headerlink" title="安装 Deno"></a>安装 Deno</h2><p>就闲聊到这里吧！让我们开始着手安装 Deno。</p>
<p>最简单的方法是使用 <a href="https://flaviocopes.com/homebrew/">Homebrew</a>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install deno</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108205-00f60477-b616-452d-a55e-44c96aa7044c.jpeg#align=left&display=inline&height=1080&margin=%5Bobject%20Object%5D&originHeight=1080&originWidth=1964&size=0&status=done&style=none&width=1964" alt=""></p>
<p>输出如上命令后，你将可以访问 <code>deno</code> 命令。帮助是<code>deno --help</code>：</p>
<blockquote>
<p>译者注：如果 HomeBrew 安装太慢可以尝试输入如下命令手动关闭 HomeBrew 的自动更新检测： <code>export HOMEBREW_NO_AUTO_UPDATE=true</code></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">flavio@mbp~&gt; deno --<span class="built_in">help</span></span><br><span class="line">deno 0.42.0</span><br><span class="line">A secure JavaScript and TypeScript runtime</span><br><span class="line"></span><br><span class="line">Docs: https://deno.land/std/manual.md</span><br><span class="line">Modules: https://deno.land/std/ https://deno.land/x/</span><br><span class="line">Bugs: https://github.com/denoland/deno/issues</span><br><span class="line"></span><br><span class="line">To start the REPL, supply no arguments:</span><br><span class="line">  deno</span><br><span class="line"></span><br><span class="line">To execute a script:</span><br><span class="line">  deno run https://deno.land/std/examples/welcome.ts</span><br><span class="line">  deno https://deno.land/std/examples/welcome.ts</span><br><span class="line"></span><br><span class="line">To evaluate code <span class="keyword">in</span> the shell:</span><br><span class="line">  deno <span class="built_in">eval</span> <span class="string">"console.log(30933 + 404)"</span></span><br><span class="line"></span><br><span class="line">Run <span class="string">'deno help run'</span> <span class="keyword">for</span> <span class="string">'run'</span>-specific flags.</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">    deno [OPTIONS] [SUBCOMMAND]</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">    -h, --<span class="built_in">help</span></span><br><span class="line">            Prints <span class="built_in">help</span> information</span><br><span class="line"></span><br><span class="line">    -L, --<span class="built_in">log</span>-level &lt;<span class="built_in">log</span>-level&gt;</span><br><span class="line">            Set <span class="built_in">log</span> level [possible values: debug, info]</span><br><span class="line"></span><br><span class="line">    -q, --quiet</span><br><span class="line">            Suppress diagnostic output</span><br><span class="line">            By default, subcommands <span class="built_in">print</span> human-readable diagnostic messages to stderr.</span><br><span class="line">            If the flag is <span class="built_in">set</span>, restrict these messages to errors.</span><br><span class="line">    -V, --version</span><br><span class="line">            Prints version information</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SUBCOMMANDS:</span><br><span class="line">    bundle         Bundle module and dependencies into single file</span><br><span class="line">    cache          Cache the dependencies</span><br><span class="line">    completions    Generate shell completions</span><br><span class="line">    doc            Show documentation <span class="keyword">for</span> a module</span><br><span class="line">    <span class="built_in">eval</span>           Eval script</span><br><span class="line">    fmt            Format <span class="built_in">source</span> files</span><br><span class="line">    <span class="built_in">help</span>           Prints this message or the <span class="built_in">help</span> of the given subcommand(s)</span><br><span class="line">    info           Show info about cache or info related to <span class="built_in">source</span> file</span><br><span class="line">    install        Install script as an executable</span><br><span class="line">    repl           Read Eval Print Loop</span><br><span class="line">    run            Run a program given a filename or url to the module</span><br><span class="line">    <span class="built_in">test</span>           Run tests</span><br><span class="line">    types          Print runtime TypeScript declarations</span><br><span class="line">    upgrade        Upgrade deno executable to newest version</span><br><span class="line"></span><br><span class="line">ENVIRONMENT VARIABLES:</span><br><span class="line">    DENO_DIR             Set deno<span class="string">'s base directory (defaults to $HOME/.deno)</span></span><br><span class="line"><span class="string">    DENO_INSTALL_ROOT    Set deno install'</span>s output directory</span><br><span class="line">                         (defaults to <span class="variable">$HOME</span>/.deno/bin)</span><br><span class="line">    NO_COLOR             Set to <span class="built_in">disable</span> color</span><br><span class="line">    HTTP_PROXY           Proxy address <span class="keyword">for</span> HTTP requests</span><br><span class="line">                         (module downloads, fetch)</span><br><span class="line">    HTTPS_PROXY          Same but <span class="keyword">for</span> HTTPS</span><br></pre></td></tr></table></figure>

<h2 id="Deno-命令"><a href="#Deno-命令" class="headerlink" title="Deno 命令"></a>Deno 命令</h2><p>请注意上节中 <code>deno --help</code> 后 <code>SUBCOMMANDS</code> 中的部分，其中列出了我们在当前版本（0.42.0）中可以运行的所有命令，如下：</p>
<ul>
<li><code>bundle</code> ：将项目的模块和依赖项捆绑到单个文件中；</li>
<li><code>cache</code> ：缓存依赖项；</li>
<li><code>completions</code> ：generate shell completions；</li>
<li><code>doc</code> ：显示某模块的文档；</li>
<li><code>eval</code> ：运行一段代码，例如 <code>deno eval &quot;console.log(1 + 2)</code> ；</li>
<li><code>fmt</code> ：内置的代码格式化程序（类似于 Go 语言中的 <code>gofmt</code>）；</li>
<li><code>help</code> ：打印某消息或某给定子命令的帮助信息；</li>
<li><code>info</code> ：显示有关缓存的信息或与源文件有关的信息；</li>
<li><code>install</code> ：将脚本安装为可执行文件；</li>
<li><code>repl</code> ：开启 REPL 环境（默认子命令）；</li>
<li><code>run</code> ：运行给定文件名或 URL 的程序；</li>
<li><code>test</code> ：运行测试；</li>
<li><code>types</code> ：打印运行时的 TypeScript 声明；</li>
<li><code>upgrade</code> ：升级 Deno 到最新版本。</li>
</ul>
<p>你可以运行 <code>deno &lt;subcommand&gt; help</code> 以获取该子命令的特定文档，例如 <code>deno run --help</code>。</p>
<p>如下所示，我们可以直接输入 <code>deno</code> 命令命令来默认启动 REPL（Read-Execute-Print-Loop）环境直接调试功能，这与运行 <code>deno repl</code> 效果是相同的。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108204-177538f5-f838-43d2-872d-7738a2e5ad74.jpeg#align=left&display=inline&height=678&margin=%5Bobject%20Object%5D&originHeight=678&originWidth=1388&size=0&status=done&style=none&width=1388" alt=""></p>
<p>一个更常见的直接使用 <code>deno</code> 命令的场景是执行在 TypeScript 文件中写的 Deno 应用程序。</p>
<blockquote>
<p>译者注：现在需要使用 <code>deno run</code> 命令而非 <code>deno</code> 命令来执行 TypeScript 文件。</p>
</blockquote>
<p>你可以同时运行 TypeScript（.ts）文件或 JavaScript（.js）文件。</p>
<p>如果你不熟悉 TypeScript，请不要担心——Deno 是用 TypeScript 编写的，并且你可以使用纯 JavaScript 编写“客户端”应用程序。</p>
<p>如果你想快速上手的 TypeScript 话，可以阅读我的 <a href="https://flaviocopes.com/typescript/">TypeScript 教程</a>。</p>
<h2 id="你的第一个-Deno-应用"><a href="#你的第一个-Deno-应用" class="headerlink" title="你的第一个 Deno 应用"></a>你的第一个 Deno 应用</h2><p>让我们来运行第一个 Deno 应用程序。</p>
<p>Deno 让我感到非常惊奇的特性是：你甚至不必写一行代码，便可以直接运行任何 URL 上的 Deno 应用程序。</p>
<p>此时 Deno 会将 URL 上的程序下载到本地并进行编译，然后运行：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108212-88b3701c-858d-4d7a-9e68-e52c159d4eac.jpeg#align=left&display=inline&height=578&margin=%5Bobject%20Object%5D&originHeight=578&originWidth=1908&size=0&status=done&style=none&width=1908" alt=""></p>
<p><strong>当然，我一般不建议从 Internet 运行无法保障安全性的代码。在这种情况下，我们先运行 Deno 官方网站上提供的 Demo；另外 Deno 还有一个沙箱，可以阻止程序执行你不希望做的事情。稍后再详细介绍。</strong></p>
<p>这个程序很简单，只需要一个<code>console.log()</code>调用：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"Welcome to Deno 🦕"</span>);</span><br></pre></td></tr></table></figure>

<p>如果使用浏览器打开直接打开 <a href="https://deno.land/std/examples/welcome.ts">https://deno.land/std/examples/welcome.ts</a> 这个 URL，则会看到以下页面：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108234-0283df4e-e0ba-4db9-85f8-af0d6ee9723e.jpeg#align=left&display=inline&height=487&margin=%5Bobject%20Object%5D&originHeight=487&originWidth=752&size=0&status=done&style=none&width=752" alt=""></p>
<p>奇怪吧？你可能期待着打开 URL 后出现一个纯 TypeScript 文件以供下载，但是我们却看到了一个网页。原因是 Deno 网站的 Web 服务器知道你正在使用浏览器，并为你提供了对用户更加友好的页面。</p>
<p>为了验证这个功能，我们可以使用 <code>wget</code> 命令来测试这个 URL， <code>wget</code> 使用 <code>text/plain</code> 下载文本而不是  <code>text/html</code>：<br><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108318-25c83547-94e1-42a2-9352-a33bd30bbae9.jpeg#align=left&display=inline&height=564&margin=%5Bobject%20Object%5D&originHeight=564&originWidth=1266&size=0&status=done&style=none&width=1266" alt=""></p>
<p>如果你想再运行这个程序，现在已经被 Deno 缓存了，不需要再下载和编译了。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108160-002b0318-a8a9-4444-87fe-6608a25fe62a.jpeg#align=left&display=inline&height=778&margin=%5Bobject%20Object%5D&originHeight=778&originWidth=1622&size=0&status=done&style=none&width=1622" alt=""></p>
<p>你可以用 <code>--reload</code> 参数强制重新下载和编译原始源码。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108280-40933589-9ba2-4337-a5b9-467534237714.jpeg#align=left&display=inline&height=578&margin=%5Bobject%20Object%5D&originHeight=578&originWidth=1622&size=0&status=done&style=none&width=1622" alt=""></p>
<p>在当前版本（0.42.0）中，<code>deno --run</code> 有许多未在 <code>deno --help</code> 清单中列出的功能。你需要运行 <code>deno run --help</code> 以显示更多。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">flavio@mbp~&gt; deno run --<span class="built_in">help</span></span><br><span class="line">deno-run</span><br><span class="line">Run a program given a filename or url to the module.</span><br><span class="line"></span><br><span class="line">By default all programs are run <span class="keyword">in</span> sandbox without access to disk, network or</span><br><span class="line">ability to spawn subprocesses.</span><br><span class="line">  deno run https://deno.land/std/examples/welcome.ts</span><br><span class="line"></span><br><span class="line">Grant all permissions:</span><br><span class="line">  deno run -A https://deno.land/std/http/file_server.ts</span><br><span class="line"></span><br><span class="line">Grant permission to <span class="built_in">read</span> from disk and listen to network:</span><br><span class="line">  deno run --allow-read --allow-net https://deno.land/std/http/file_server.ts</span><br><span class="line"></span><br><span class="line">Grant permission to <span class="built_in">read</span> whitelisted files from disk:</span><br><span class="line">  deno run --allow-read=/etc https://deno.land/std/http/file_server.ts</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">    deno run [OPTIONS] &lt;SCRIPT_ARG&gt;...</span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">    -A, --allow-all</span><br><span class="line">            Allow all permissions</span><br><span class="line"></span><br><span class="line">        --allow-env</span><br><span class="line">            Allow environment access</span><br><span class="line"></span><br><span class="line">        --allow-hrtime</span><br><span class="line">            Allow high resolution time measurement</span><br><span class="line"></span><br><span class="line">        --allow-net=&lt;allow-net&gt;</span><br><span class="line">            Allow network access</span><br><span class="line"></span><br><span class="line">        --allow-plugin</span><br><span class="line">            Allow loading plugins</span><br><span class="line"></span><br><span class="line">        --allow-read=&lt;allow-read&gt;</span><br><span class="line">            Allow file system <span class="built_in">read</span> access</span><br><span class="line"></span><br><span class="line">        --allow-run</span><br><span class="line">            Allow running subprocesses</span><br><span class="line"></span><br><span class="line">        --allow-write=&lt;allow-write&gt;</span><br><span class="line">            Allow file system write access</span><br><span class="line"></span><br><span class="line">        --cached-only</span><br><span class="line">            Require that remote dependencies are already cached</span><br><span class="line"></span><br><span class="line">        --cert &lt;FILE&gt;</span><br><span class="line">            Load certificate authority from PEM encoded file</span><br><span class="line"></span><br><span class="line">    -c, --config &lt;FILE&gt;</span><br><span class="line">            Load tsconfig.json configuration file</span><br><span class="line"></span><br><span class="line">    -h, --<span class="built_in">help</span></span><br><span class="line">            Prints <span class="built_in">help</span> information</span><br><span class="line"></span><br><span class="line">        --importmap &lt;FILE&gt;</span><br><span class="line">            UNSTABLE:</span><br><span class="line">            Load import map file</span><br><span class="line">            Docs: https://deno.land/std/manual.md<span class="comment">#import-maps</span></span><br><span class="line">            Specification: https://wicg.github.io/import-maps/</span><br><span class="line">            Examples: https://github.com/WICG/import-maps<span class="comment">#the-import-map</span></span><br><span class="line">        --inspect=&lt;HOST:PORT&gt;</span><br><span class="line">            activate inspector on host:port (default: 127.0.0.1:9229)</span><br><span class="line"></span><br><span class="line">        --inspect-brk=&lt;HOST:PORT&gt;</span><br><span class="line">            activate inspector on host:port and <span class="built_in">break</span> at start of user script</span><br><span class="line"></span><br><span class="line">        --lock &lt;FILE&gt;</span><br><span class="line">            Check the specified lock file</span><br><span class="line"></span><br><span class="line">        --lock-write</span><br><span class="line">            Write lock file. Use with --lock.</span><br><span class="line"></span><br><span class="line">    -L, --<span class="built_in">log</span>-level &lt;<span class="built_in">log</span>-level&gt;</span><br><span class="line">            Set <span class="built_in">log</span> level [possible values: debug, info]</span><br><span class="line"></span><br><span class="line">        --no-remote</span><br><span class="line">            Do not resolve remote modules</span><br><span class="line"></span><br><span class="line">    -q, --quiet</span><br><span class="line">            Suppress diagnostic output</span><br><span class="line">            By default, subcommands <span class="built_in">print</span> human-readable diagnostic messages to stderr.</span><br><span class="line">            If the flag is <span class="built_in">set</span>, restrict these messages to errors.</span><br><span class="line">    -r, --reload=&lt;CACHE_BLACKLIST&gt;</span><br><span class="line">            Reload <span class="built_in">source</span> code cache (recompile TypeScript)</span><br><span class="line">            --reload</span><br><span class="line">              Reload everything</span><br><span class="line">            --reload=https://deno.land/std</span><br><span class="line">              Reload only standard modules</span><br><span class="line">            --reload=https://deno.land/std/fs/utils.ts,https://deno.land/std/fmt/colors.ts</span><br><span class="line">              Reloads specific modules</span><br><span class="line">        --seed &lt;NUMBER&gt;</span><br><span class="line">            Seed Math.random()</span><br><span class="line"></span><br><span class="line">        --unstable</span><br><span class="line">            Enable unstable APIs</span><br><span class="line"></span><br><span class="line">        --v8-flags=&lt;v8-flags&gt;</span><br><span class="line">            Set V8 <span class="built_in">command</span> line options. For <span class="built_in">help</span>: --v8-flags=--<span class="built_in">help</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ARGS:</span><br><span class="line">    &lt;SCRIPT_ARG&gt;...</span><br><span class="line">            script args</span><br></pre></td></tr></table></figure>

<h2 id="Deno-代码实例"><a href="#Deno-代码实例" class="headerlink" title="Deno 代码实例"></a>Deno 代码实例</h2><p>除了前文我们运行的 Demo 外，Deno 官网还提供了一些其他的例子，可以在这里查看：<a href="https://deno.land/std/examples/">https://deno.land/std/examples/</a>。</p>
<blockquote>
<p>译者注：你可能需要配置代理来更好地访问 DenoLand。</p>
</blockquote>
<p>在撰写本手册时，我们可以找到：</p>
<ul>
<li><code>cat.ts</code> ：打印的内容是作为参数提供的文件列表；</li>
<li><code>catj.ts</code> ：打印的内容是作为参数提供的文件列表；</li>
<li><code>chat/</code> ：聊天的一种实现；</li>
<li><code>colors.ts</code> ：打印一个彩色版本的 Hello world!；</li>
<li><code>curl.ts</code> ：一个简单的实现，curl 它打印指定为参数的 URL 的内容；</li>
<li><code>echo_server.ts</code> ：TCP 回显服务器；</li>
<li><code>gist.ts</code> ：一个将文件发布到 gist.github.com 的程序；</li>
<li><code>test.ts</code> ：样本测试套件；</li>
<li><code>welcome.ts</code> ：一个简单的 console.log 语句（我们在上面运行的第一个程序）；</li>
<li><code>xeval.ts</code> ：允许你为收到的任何标准输入行运行任何 TypeScript 代码。曾经被设计为 <code>deno xeval</code> 子命令但现在从官方命令中删除。</li>
</ul>
<h2 id="你的第一个-Deno-应用（深入版）"><a href="#你的第一个-Deno-应用（深入版）" class="headerlink" title="你的第一个 Deno 应用（深入版）"></a>你的第一个 Deno 应用（深入版）</h2><p>我们来写一些代码吧。</p>
<p>前文执行的 <code>deno run [https://deno.land/std/examples/welcome.ts](https://deno.land/std/examples/welcome.ts)</code> 命令执行的是官网提供的一个 Deno 应用，所以我们没有看到任何关于 Deno 代码具体的样子。</p>
<p>接下来让我们从 Deno 官方网站上列出的默认示例应用开始。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; serve &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std/http/server.ts"</span>;</span><br><span class="line"><span class="keyword">const</span> s = serve(&#123; port: <span class="number">8000</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"http://localhost:8000/"</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> req of s) &#123;</span><br><span class="line">  req.respond(&#123; body: <span class="string">"Hello World\n"</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码从 <code>http/server</code> 模块中导入服务函数。可见我们不需要先安装这些模块，而且也不会像 Node.js 那样将这些模块大量存储在本地机器上。这也是 Deno 安装速度快的原因之一。</p>
<p>从 <code>[https://deno.land/std/http/server.ts](https://deno.land/std/http/server.ts)</code> 中导入会导入最新版本的模块。你可以使用<code>@VERSION</code>导入特定的版本，如下所示。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; serve &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std@v0.42.0/http/server.ts"</span>;</span><br></pre></td></tr></table></figure>

<p>该 serve 函数在此文件中的定义如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create a HTTP server</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *     import &#123; serve &#125; from "https://deno.land/std/http/server.ts";</span></span><br><span class="line"><span class="comment"> *     const body = "Hello World\n";</span></span><br><span class="line"><span class="comment"> *     const s = serve(&#123; port: 8000 &#125;);</span></span><br><span class="line"><span class="comment"> *     for await (const req of s) &#123;</span></span><br><span class="line"><span class="comment"> *       req.respond(&#123; body &#125;);</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">serve</span>(<span class="params">addr: <span class="built_in">string</span> | HTTPOptions</span>): <span class="title">Server</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> addr === <span class="string">"string"</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [hostname, port] = addr.split(<span class="string">":"</span>);</span><br><span class="line">    addr = &#123; hostname, port: <span class="built_in">Number</span>(port) &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> listener = listen(addr);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Server(listener);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们接下来实例化一个服务器，调用 <code>server()</code> 函数传递一个带有端口属性的对象。</p>
<p>然后我们运行如下循环来响应来自服务器的每一个请求。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> req of s) &#123;</span><br><span class="line">  req.respond(&#123; body: <span class="string">"Hello World\n"</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请注意，我们在这里使用 <code>await</code> 关键字而不需要将其封装到异步函数中，因为 Deno 在其内部实现了顶层的 <code>await</code> 支持。</p>
<p>让我们在本地运行这个程序。假设你使用的是 VS Code（你可以使用任何你喜欢的编辑器），我建议从 <code>justjavac</code> 开发的 Deno VS Code 扩展入手（当我尝试的时候还有一个同名的扩展，但是已经被淘汰了，可能将来会消失）。</p>
<blockquote>
<p>译者注：justjavac 的 Deno VS Code 拓展将被官方收录，以后可以直接使用官方的拓展。</p>
</blockquote>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108587-ce37d813-3c3c-4aa5-8be2-9edeb4128efb.jpeg#align=left&display=inline&height=940&margin=%5Bobject%20Object%5D&originHeight=940&originWidth=1375&size=0&status=done&style=none&width=1375" alt=""></p>
<p>该扩展将为 <code>VS Code</code> 提供几个实用工具和不错的东西来帮助你编写应用程序。</p>
<p>现在在一个文件夹中创建一个 <code>app.ts</code> 文件，然后粘贴上面的代码。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108193-34529ea2-a542-4d14-911a-5cc9c2c0ae2a.jpeg#align=left&display=inline&height=751&margin=%5Bobject%20Object%5D&originHeight=751&originWidth=1059&size=0&status=done&style=none&width=1059" alt=""></p>
<p>现在用 <code>deno run app.ts</code> 命令运行它。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108258-3a5d47d0-1630-4950-907a-9dc14399ed1c.jpeg#align=left&display=inline&height=1014&margin=%5Bobject%20Object%5D&originHeight=1014&originWidth=1266&size=0&status=done&style=none&width=1266" alt=""></p>
<p>Deno 会先下载、编译我们导入的那个依赖及其所有需要的依赖项。</p>
<p>这是由于我们导入的 <code>[https://deno.land/std/http/server.ts](https://deno.land/std/http/server.ts)</code> 文件本身就有数个其它依赖：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; encode &#125; <span class="keyword">from</span> <span class="string">"../encoding/utf8.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BufReader, BufWriter &#125; <span class="keyword">from</span> <span class="string">"../io/bufio.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; assert &#125; <span class="keyword">from</span> <span class="string">"../testing/asserts.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deferred, Deferred, MuxAsyncIterator &#125; <span class="keyword">from</span> <span class="string">"../async/mod.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  bodyReader,</span><br><span class="line">  chunkedBodyReader,</span><br><span class="line">  emptyReader,</span><br><span class="line">  writeResponse,</span><br><span class="line">  readRequest,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"./_io.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> Listener = Deno.Listener;</span><br><span class="line"><span class="keyword">import</span> Conn = Deno.Conn;</span><br><span class="line"><span class="keyword">import</span> Reader = Deno.Reader;</span><br></pre></td></tr></table></figure>

<p>但 Deno 都会帮我们自动导入。</p>
<p>在最后，我们还有一个问题。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108249-f25465bc-528c-44f8-91bf-a9cb5530258a.jpeg#align=left&display=inline&height=364&margin=%5Bobject%20Object%5D&originHeight=364&originWidth=1266&size=0&status=done&style=none&width=1266" alt=""></p>
<p>这是怎么回事？我们为什么会收到执行权限被拒绝的提示？</p>
<p>这就涉及到了 Deno 的 Sandbox 问题，我们一起来看看。</p>
<h2 id="Deno-安全沙箱（Sandbox）"><a href="#Deno-安全沙箱（Sandbox）" class="headerlink" title="Deno 安全沙箱（Sandbox）"></a>Deno 安全沙箱（Sandbox）</h2><p>我之前提到过，Deno 有一个安全沙箱，可以防止程序做一些你不允许的事情。</p>
<p>这意味着什么呢？</p>
<p>Ryan 曾在 Deno 的介绍讲座中提到的一件事是：有时候你想在 Web 浏览器之外运行一个 JavaScript 程序，却不想让它肆意在你的系统中访问任何它想要的东西，比如使用网络与外部世界对话。</p>
<p>为什么我们通常只安装来自可信来源的 Node.js 包？这是因为没有什么可以阻止 Node.js 程序获取你系统上的 SSH 密钥或其他任何东西，并将其发送到服务器上。但是，我们该怎么知道自己或其他人使用的一个项目是否被黑客入侵了？</p>
<p>Deno 的解决方案是试图大量借鉴浏览器实现相同的权限模型——除非你明确允许，否则在浏览器中运行的任何 JavaScript 都不能在你的系统上做不正当的事情。</p>
<p>回到 Deno，如果一个程序想要像前面的例子一样访问网络，那么我们需要给它权限。</p>
<p>我们可以通过在运行命令时传递一个标志来实现，本例中是 <code>--allow-net</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-net app.ts</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108284-f40a4a1b-361a-4d66-8fc6-3565b5f78df3.jpeg#align=left&display=inline&height=264&margin=%5Bobject%20Object%5D&originHeight=264&originWidth=850&size=0&status=done&style=none&width=850" alt=""></p>
<p>该应用程序现在监听在 8000 端口上运行着 HTTP 服务器：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108404-f8d8f085-033f-4d0d-8ceb-26be08149324.jpeg#align=left&display=inline&height=487&margin=%5Bobject%20Object%5D&originHeight=487&originWidth=908&size=0&status=done&style=none&width=908" alt=""></p>
<p>其他标志允许 Deno 解锁其他功能，如下所示：</p>
<ul>
<li><code>--allow-env</code> ：允许访问环境变量；</li>
<li><code>--allow-hrtime</code> ：允许高分辨率时间测量；</li>
<li><code>--allow-net=&lt;allow-net&gt;</code> ：允许网络访问；</li>
<li><code>--allow-plugin</code> ：允许加载插件；</li>
<li><code>--allow-read=&lt;allow-read&gt;</code> ：允许文件系统读取权限；</li>
<li><code>--allow-run</code> ：允许运行子进程；</li>
<li><code>--allow-write=&lt;allow-write&gt;</code> ：允许文件系统写入访问；</li>
<li><code>--allow-all</code> ：允许所有权限(与<code>-A</code>相同)。</li>
</ul>
<p>其中，<code>net</code>、<code>read</code> 和 <code>write</code> 的权限可以是细化的。例如，你可以使用 <code>--allow-read=/dev</code>，允许从特定文件夹中读取。</p>
<h2 id="格式化代码"><a href="#格式化代码" class="headerlink" title="格式化代码"></a>格式化代码</h2><p>Go 语言编译器自带的 <code>gofmt</code> 命令是我非常喜欢 Go 语言特性之一。所有的 Go 代码的格式看起来都是一样的。每位 Go 程序员都在使用 <code>gofmt</code>。</p>
<p>JavaScript 程序员都习惯于运行 <a href="https://flaviocopes.com/prettier/">Prettier</a> 工具，而 <code>deno fmt</code> 实际上直接内置相关库到底层上运行。</p>
<p>假设你有一个格式化问题严重的文件如下图所示。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108254-49bb0133-c6c2-4ebb-82e9-b0240541f0e0.jpeg#align=left&display=inline&height=751&margin=%5Bobject%20Object%5D&originHeight=751&originWidth=1059&size=0&status=done&style=none&width=1059" alt=""></p>
<p>你运行 <code>deno fmt app.ts</code>，它就会执行正确的代码格式化，包括自动加上缺失的分号。</p>
<h2 id="标准库"><a href="#标准库" class="headerlink" title="标准库"></a>标准库</h2><p>尽管 Deno 还很年轻，但它的标准库仍然很庞大。这包括：</p>
<ul>
<li><code>archive</code> ：tar 文件归档的实用程序</li>
<li><code>async</code> ：异步工具</li>
<li><code>bytes</code> ：帮助器来操作字节切片</li>
<li><code>datetime</code> ：日期 / 时间解析</li>
<li><code>encoding</code> ：各种格式的编码/解码</li>
<li><code>flags</code> ：解析命令行标志</li>
<li><code>fmt</code> ：格式化和打印</li>
<li><code>fs</code> ：文件系统 API</li>
<li><code>hash</code> ：加密库</li>
<li><code>http</code> ：HTTP 服务器</li>
<li><code>io</code> ：I/O 库</li>
<li><code>log</code> ：日志实用程序</li>
<li><code>mime</code> ：支持多类型数据</li>
<li><code>node</code> ：Node.js 兼容层</li>
<li><code>path</code> ：路径操纵</li>
<li><code>ws</code> ：WebSockets</li>
</ul>
<h2 id="另一个-Deno-示例"><a href="#另一个-Deno-示例" class="headerlink" title="另一个 Deno 示例"></a>另一个 Deno 示例</h2><p>我们再来看看另一个 Deno APP 的例子，以如下 <code>cat.ts</code> 为例。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> filenames = Deno.args;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> filename of filenames) &#123;</span><br><span class="line">  <span class="keyword">const</span> file = <span class="keyword">await</span> Deno.open(filename);</span><br><span class="line">  <span class="keyword">await</span> Deno.copy(file, Deno.stdout);</span><br><span class="line">  file.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里把 <code>Deno.args</code> 的值分配给了 filenames 变量，<code>Deno.args</code> 是一个包含所有发送到命令中的参数的变量。</p>
<p>我们对这些参数进行迭代：对每一个参数，我们使用 <code>Deno.open()</code> 打开文件，并使用 <code>Deno.copy()</code> 将文件的内容打印到 <code>Deno.stdout</code> 中，最后我们关闭该文件。</p>
<p>如果你使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run https://deno.land/std/examples/cat.ts</span><br></pre></td></tr></table></figure>

<p>程序被下载编译后，由于我们没有指定任何参数，所以没有发生任何事情。</p>
<p>现在试试这个：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run https://deno.land/std/examples/cat.ts app.ts</span><br></pre></td></tr></table></figure>

<p>假设你在同一个文件夹里有之前项目中的 <code>app.ts</code>。</p>
<p>你会得到如下权限错误。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108211-4239256a-5731-471c-b8ad-496b5a1b308a.jpeg#align=left&display=inline&height=489&margin=%5Bobject%20Object%5D&originHeight=489&originWidth=967&size=0&status=done&style=none&width=967" alt=""></p>
<p>这是因为 Deno 默认情况下不允许访问文件系统。需要使用 <code>--allow-read=./</code> 命令授予对当前文件夹的访问权限：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-read=./ https://deno.land/std/examples/cat.ts app.ts</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108327-f72d7fd6-6971-4799-a9f0-19f07f536cd4.jpeg#align=left&display=inline&height=439&margin=%5Bobject%20Object%5D&originHeight=439&originWidth=967&size=0&status=done&style=none&width=967" alt=""></p>
<h2 id="Deno-是否有-Express-Hapi-Koa"><a href="#Deno-是否有-Express-Hapi-Koa" class="headerlink" title="Deno 是否有 Express/Hapi/Koa/*"></a>Deno 是否有 Express/Hapi/Koa/*</h2><p>当然有。可以看看下方这些库。</p>
<ul>
<li><a href="https://github.com/drashland/deno-drash">deno-drash</a></li>
<li><a href="https://github.com/NMathar/deno-express">deno-express</a></li>
<li><a href="https://github.com/oakserver/oak">oak</a></li>
<li><a href="https://github.com/sholladay/pogo">pogo</a></li>
<li><a href="https://github.com/keroxp/servest">servest</a></li>
</ul>
<h2 id="示例：使用-Oak-构建-REST-API"><a href="#示例：使用-Oak-构建-REST-API" class="headerlink" title="示例：使用 Oak 构建 REST-API"></a>示例：使用 Oak 构建 REST-API</h2><p>我想在这里做一个简单的 Demo 实战，介绍一下如何使用 Oak 框架构建<code>REST API</code>。Oak 很有意思，因为它的灵感来自于 Koa，一个流行的 Node.js 中间件。正因为如此，如果你以前用过 Koa 的话，会很快熟悉 Oak。</p>
<p>我们要构建的 API 示例也非常简单。</p>
<p>我们的服务器将在内存中存储一个带有名字和年龄的旺柴的列表。</p>
<p>我们的需求是：</p>
<ul>
<li>添加旺柴；</li>
<li>列出旺柴；</li>
<li>获取有关特定旺柴的详细信息；</li>
<li>从名单上删除一只旺柴；</li>
<li>更新旺柴的年龄。</li>
</ul>
<p>我们将使用 TypeScript 进行此操作，但是没有什么可以阻止你使用 JavaScript 编写 API——你只需要删除下方 TypeScript 文件中所有有关类型描述的代码并将文件名后缀改为 <code>.js</code>。</p>
<p>创建一个 <code>app.ts</code> 文件。</p>
<p>让我们开始从 Oak 导入 <code>Application</code> 和 <code>Router</code> 对象：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Application, Router &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/x/oak/mod.ts"</span>;</span><br></pre></td></tr></table></figure>

<p>然后我们得到环境变量 <code>PORT</code> 和 <code>HOST</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> env = Deno.env.toObject();</span><br><span class="line"><span class="keyword">const</span> PORT = env.PORT || <span class="number">4000</span>;</span><br><span class="line"><span class="keyword">const</span> HOST = env.HOST || <span class="string">"127.0.0.1"</span>;</span><br></pre></td></tr></table></figure>

<p>默认情况下，我们的应用程序将在 <code>localhost：4000</code> 上运行。</p>
<p>现在，我们创建 <code>Oak</code> 应用程序并启动它：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Application();</span><br><span class="line"></span><br><span class="line">app.use(router.routes());</span><br><span class="line">app.use(router.allowedMethods());</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Listening on port <span class="subst">$&#123;PORT&#125;</span>...`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> app.listen(<span class="string">`<span class="subst">$&#123;HOST&#125;</span>:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br></pre></td></tr></table></figure>

<p>现在，应用程序应该可以正常编译了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno run --allow-env --allow-net app.ts</span><br></pre></td></tr></table></figure>

<p>然后 Deno 将下载依赖项：</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108275-215875c2-13ed-4ac7-b58b-22a2e21b6805.jpeg#align=left&display=inline&height=1123&margin=%5Bobject%20Object%5D&originHeight=1123&originWidth=923&size=0&status=done&style=none&width=923" alt=""></p>
<p>这时程序监听在 <code>4000</code> 端口上。</p>
<p>下次运行该命令时，Deno 会跳过安装部分，因为这些包已经被缓存了。</p>
<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108253-c730a830-ac38-4909-a7e1-fb0895cd45e9.jpeg#align=left&display=inline&height=339&margin=%5Bobject%20Object%5D&originHeight=339&originWidth=1084&size=0&status=done&style=none&width=1084" alt=""></p>
<p>在文件的顶部，让我们定义一个旺柴的接口，然后我们声明一个初始的 <code>Dogs</code> 数组 <code>Dog</code> 对象。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Dog &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogs: <span class="built_in">Array</span>&lt;Dog&gt; = [</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">"Roger"</span>,</span><br><span class="line">    age: <span class="number">8</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">"Syd"</span>,</span><br><span class="line">    age: <span class="number">7</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>现在，让我们来实现具体 API。</p>
<p>我们已经准备好了一切。在你创建了路由器之后，让我们添加一些函数，这些函数将在任何时候触发这些路由中的一个端点时被调用。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br><span class="line"></span><br><span class="line">router</span><br><span class="line">  .get(<span class="string">"/dogs"</span>, getDogs)</span><br><span class="line">  .get(<span class="string">"/dogs/:name"</span>, getDog)</span><br><span class="line">  .post(<span class="string">"/dogs"</span>, addDog)</span><br><span class="line">  .put(<span class="string">"/dogs/:name"</span>, updateDog)</span><br><span class="line">  .delete(<span class="string">"/dogs/:name"</span>, removeDog);</span><br></pre></td></tr></table></figure>

<p>看到了吗？我们的 API 定义是：</p>
<ul>
<li><code>GET /dogs</code></li>
<li><code>GET /dogs/:name</code></li>
<li><code>POST /dogs</code></li>
<li><code>PUT /dogs/:name</code></li>
<li><code>DELETE /dogs/:name</code></li>
</ul>
<p>让我们开始一一实现。</p>
<p>从开始 <code>GET /dogs</code>，它将返回所有旺柴的列表：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDogs = <span class="function">(<span class="params">&#123; response &#125;: &#123; response: <span class="built_in">any</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  response.body = dogs;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108268-7efd6854-4555-47eb-afa1-9e2c853bd2c0.jpeg#align=left&display=inline&height=624&margin=%5Bobject%20Object%5D&originHeight=624&originWidth=879&size=0&status=done&style=none&width=879" alt=""></p>
<p>接下来，我们就来看看如何通过名字来检索旺柴。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDog = (&#123;</span><br><span class="line">  params,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> dog = dogs.filter(<span class="function">(<span class="params">dog</span>) =&gt;</span> dog.name === params.name);</span><br><span class="line">  <span class="keyword">if</span> (dog.length) &#123;</span><br><span class="line">    response.status = <span class="number">200</span>;</span><br><span class="line">    response.body = dog[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.status = <span class="number">400</span>;</span><br><span class="line">  response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108264-40e48063-e125-4d38-bdbf-269d8ed0b608.jpeg#align=left&display=inline&height=624&margin=%5Bobject%20Object%5D&originHeight=624&originWidth=879&size=0&status=done&style=none&width=879" alt=""></p>
<p>这是我们添加一个新的旺柴的方法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addDog = <span class="keyword">async</span> (&#123;</span><br><span class="line">  request,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  request: <span class="built_in">any</span>;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> body = <span class="keyword">await</span> request.body();</span><br><span class="line">  <span class="keyword">const</span> dog: Dog = body.value;</span><br><span class="line">  dogs.push(dog);</span><br><span class="line"></span><br><span class="line">  response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">  response.status = <span class="number">200</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108248-a5198b2e-db87-4370-aa93-e9d1be6eb73e.jpeg#align=left&display=inline&height=624&margin=%5Bobject%20Object%5D&originHeight=624&originWidth=879&size=0&status=done&style=none&width=879" alt=""></p>
<p>注意，我现在使用 <code>const body = await request.body()</code> 来获取正文的内容，因为 <code>name</code> 和 <code>age</code> 值是以 JSON 的形式传递的。</p>
<p>这是我们更新旺柴的年龄的方法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> updateDog = <span class="keyword">async</span> (&#123;</span><br><span class="line">  params,</span><br><span class="line">  request,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  request: <span class="built_in">any</span>;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> temp = dogs.filter(<span class="function">(<span class="params">existingDog</span>) =&gt;</span> existingDog.name === params.name);</span><br><span class="line">  <span class="keyword">const</span> body = <span class="keyword">await</span> request.body();</span><br><span class="line">  <span class="keyword">const</span> &#123; age &#125;: &#123; age: <span class="built_in">number</span> &#125; = body.value;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (temp.length) &#123;</span><br><span class="line">    temp[<span class="number">0</span>].age = age;</span><br><span class="line">    response.status = <span class="number">200</span>;</span><br><span class="line">    response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.status = <span class="number">400</span>;</span><br><span class="line">  response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108243-5c436797-023f-42c3-a47c-02c97d026a64.jpeg#align=left&display=inline&height=624&margin=%5Bobject%20Object%5D&originHeight=624&originWidth=879&size=0&status=done&style=none&width=879" alt=""></p>
<p>这是我们如何从列表中删除旺柴的方法：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeDog = (&#123;</span><br><span class="line">  params,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> lengthBefore = dogs.length;</span><br><span class="line">  dogs = dogs.filter(<span class="function">(<span class="params">dog</span>) =&gt;</span> dog.name !== params.name);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (dogs.length === lengthBefore) &#123;</span><br><span class="line">    response.status = <span class="number">400</span>;</span><br><span class="line">    response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">  response.status = <span class="number">200</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2020/jpeg/86548/1589798108280-d05de626-aa2f-45f2-84f9-4fbe37e76a33.jpeg#align=left&display=inline&height=624&margin=%5Bobject%20Object%5D&originHeight=624&originWidth=879&size=0&status=done&style=none&width=879" alt=""></p>
<p>这是完整的示例代码：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Application, Router &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/x/oak/mod.ts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> env = Deno.env.toObject();</span><br><span class="line"><span class="keyword">const</span> PORT = env.PORT || <span class="number">4000</span>;</span><br><span class="line"><span class="keyword">const</span> HOST = env.HOST || <span class="string">"127.0.0.1"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Dog &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> dogs: <span class="built_in">Array</span>&lt;Dog&gt; = [</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">"Roger"</span>,</span><br><span class="line">    age: <span class="number">8</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">"Syd"</span>,</span><br><span class="line">    age: <span class="number">7</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDogs = <span class="function">(<span class="params">&#123; response &#125;: &#123; response: <span class="built_in">any</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  response.body = dogs;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getDog = (&#123;</span><br><span class="line">  params,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> dog = dogs.filter(<span class="function">(<span class="params">dog</span>) =&gt;</span> dog.name === params.name);</span><br><span class="line">  <span class="keyword">if</span> (dog.length) &#123;</span><br><span class="line">    response.status = <span class="number">200</span>;</span><br><span class="line">    response.body = dog[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.status = <span class="number">400</span>;</span><br><span class="line">  response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addDog = <span class="keyword">async</span> (&#123;</span><br><span class="line">  request,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  request: <span class="built_in">any</span>;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> body = <span class="keyword">await</span> request.body();</span><br><span class="line">  <span class="keyword">const</span> &#123; name, age &#125;: &#123; name: <span class="built_in">string</span>; age: <span class="built_in">number</span> &#125; = body.value;</span><br><span class="line">  dogs.push(&#123;</span><br><span class="line">    name: name,</span><br><span class="line">    age: age,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">  response.status = <span class="number">200</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> updateDog = <span class="keyword">async</span> (&#123;</span><br><span class="line">  params,</span><br><span class="line">  request,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  request: <span class="built_in">any</span>;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> temp = dogs.filter(<span class="function">(<span class="params">existingDog</span>) =&gt;</span> existingDog.name === params.name);</span><br><span class="line">  <span class="keyword">const</span> body = <span class="keyword">await</span> request.body();</span><br><span class="line">  <span class="keyword">const</span> &#123; age &#125;: &#123; age: <span class="built_in">number</span> &#125; = body.value;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (temp.length) &#123;</span><br><span class="line">    temp[<span class="number">0</span>].age = age;</span><br><span class="line">    response.status = <span class="number">200</span>;</span><br><span class="line">    response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.status = <span class="number">400</span>;</span><br><span class="line">  response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> removeDog = (&#123;</span><br><span class="line">  params,</span><br><span class="line">  response,</span><br><span class="line">&#125;: &#123;</span><br><span class="line">  params: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  response: <span class="built_in">any</span>;</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> lengthBefore = dogs.length;</span><br><span class="line">  dogs = dogs.filter(<span class="function">(<span class="params">dog</span>) =&gt;</span> dog.name !== params.name);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (dogs.length === lengthBefore) &#123;</span><br><span class="line">    response.status = <span class="number">400</span>;</span><br><span class="line">    response.body = &#123; msg: <span class="string">`Cannot find dog <span class="subst">$&#123;params.name&#125;</span>`</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  response.body = &#123; msg: <span class="string">"OK"</span> &#125;;</span><br><span class="line">  response.status = <span class="number">200</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br><span class="line">router</span><br><span class="line">  .get(<span class="string">"/dogs"</span>, getDogs)</span><br><span class="line">  .get(<span class="string">"/dogs/:name"</span>, getDog)</span><br><span class="line">  .post(<span class="string">"/dogs"</span>, addDog)</span><br><span class="line">  .put(<span class="string">"/dogs/:name"</span>, updateDog)</span><br><span class="line">  .delete(<span class="string">"/dogs/:name"</span>, removeDog);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Application();</span><br><span class="line"></span><br><span class="line">app.use(router.routes());</span><br><span class="line">app.use(router.allowedMethods());</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Listening on port <span class="subst">$&#123;PORT&#125;</span>...`</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> app.listen(<span class="string">`<span class="subst">$&#123;HOST&#125;</span>:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br></pre></td></tr></table></figure>

<h2 id="更多内容"><a href="#更多内容" class="headerlink" title="更多内容"></a>更多内容</h2><p>Deno 官方网站为 <a href="https://deno.land">https://deno.land</a>。</p>
<p>API 文档位于 <a href="https://doc.deno.land">https://doc.deno.land</a> 和 <a href="https://deno.land/typedoc/index.html">https://deno.land/typedoc/index.html</a> 中。</p>
<p>一份 Awesome Deno 资源清单 <a href="https://github.com/denolib/awesome-deno">https://github.com/denolib/awesome-deno</a>。</p>
<blockquote>
<p>译者注：中文的 Awesome Deno 清单由译者持续维护中，可以访问这里：<a href="https://github.com/hylerrix/awesome-deno-cn">Awesome Deno 资源全图谱</a></p>
</blockquote>
<h2 id="花絮"><a href="#花絮" class="headerlink" title="花絮"></a>花絮</h2><ul>
<li>Deno 提供了一个内置的 <code>fetch</code> 实现，该实现与浏览器中可用的匹配。</li>
<li>Deno 正在进行与 Node.js stdlib 的兼容层</li>
</ul>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>我希望你喜欢这个 Deno 入门手册！</p>
<p>别忘了，<a href="https://flaviocopes.com/page/deno-handbook/">你可以在此处获取此 Deno 手册的 PDF / ePub / Mobi 版本。</a></p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/blog/tags/Deno/">Deno</a><a class="link-muted mr-2" rel="tag" href="/blog/tags/TypeScript/">TypeScript</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/blog/" alt="Alipay"></span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/blog/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/blog/2020/05/22/00B-awesome-deno-cn/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Awesome Deno 中文资源全图谱</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/2020/05/13/009-hello-deno-tutorial/"><span class="level-item">Hello，从多样化安装到简单实战</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars3.githubusercontent.com/u/19285461" alt="hylerrix(韩亦乐)"></figure><p class="title is-size-4 is-block line-height-inherit">hylerrix(韩亦乐)</p><p class="is-size-6 is-block">NingoWood(凝果屋)</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Beijing, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/blog/archives"><p class="title">14</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/blog/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/blog/tags"><p class="title">20</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hylerrix" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/hylerrix"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com/hylerrix"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/hylerrix"><i class="fab fa-twitter"></i></a></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex" href="#目录"><span class="mr-2">1</span><span>目录</span></a></li><li><a class="is-flex" href="#什么是-Deno？"><span class="mr-2">2</span><span>什么是 Deno？</span></a></li><li><a class="is-flex" href="#为什么是-Deno？为什么是现在？"><span class="mr-2">3</span><span>为什么是 Deno？为什么是现在？</span></a></li><li><a class="is-flex" href="#你应该学习-Deno-吗？"><span class="mr-2">4</span><span>你应该学习 Deno 吗？</span></a></li><li><a class="is-flex" href="#Deno-将取代-Node-js-吗？"><span class="mr-2">5</span><span>Deno 将取代 Node.js 吗？</span></a></li><li><a class="is-flex" href="#一流的-TypeScript-支持"><span class="mr-2">6</span><span>一流的 TypeScript 支持</span></a></li><li><a class="is-flex" href="#与-Node-js-的异同"><span class="mr-2">7</span><span>与 Node.js 的异同</span></a></li><li><a class="is-flex" href="#没有包依赖管理器"><span class="mr-2">8</span><span>没有包依赖管理器</span></a></li><li><a class="is-flex" href="#安装-Deno"><span class="mr-2">9</span><span>安装 Deno</span></a></li><li><a class="is-flex" href="#Deno-命令"><span class="mr-2">10</span><span>Deno 命令</span></a></li><li><a class="is-flex" href="#你的第一个-Deno-应用"><span class="mr-2">11</span><span>你的第一个 Deno 应用</span></a></li><li><a class="is-flex" href="#Deno-代码实例"><span class="mr-2">12</span><span>Deno 代码实例</span></a></li><li><a class="is-flex" href="#你的第一个-Deno-应用（深入版）"><span class="mr-2">13</span><span>你的第一个 Deno 应用（深入版）</span></a></li><li><a class="is-flex" href="#Deno-安全沙箱（Sandbox）"><span class="mr-2">14</span><span>Deno 安全沙箱（Sandbox）</span></a></li><li><a class="is-flex" href="#格式化代码"><span class="mr-2">15</span><span>格式化代码</span></a></li><li><a class="is-flex" href="#标准库"><span class="mr-2">16</span><span>标准库</span></a></li><li><a class="is-flex" href="#另一个-Deno-示例"><span class="mr-2">17</span><span>另一个 Deno 示例</span></a></li><li><a class="is-flex" href="#Deno-是否有-Express-Hapi-Koa"><span class="mr-2">18</span><span>Deno 是否有 Express/Hapi/Koa/*</span></a></li><li><a class="is-flex" href="#示例：使用-Oak-构建-REST-API"><span class="mr-2">19</span><span>示例：使用 Oak 构建 REST-API</span></a></li><li><a class="is-flex" href="#更多内容"><span class="mr-2">20</span><span>更多内容</span></a></li><li><a class="is-flex" href="#花絮"><span class="mr-2">21</span><span>花絮</span></a></li><li><a class="is-flex" href="#结语"><span class="mr-2">22</span><span>结语</span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://github.com/ningowood" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">NingoWood</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/"><span class="level-start"><span class="level-item">Deno 钻研之术</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/categories/JavaScript-%E6%8A%80%E6%9C%AF%E7%B2%BE%E8%BF%9B/"><span class="level-start"><span class="level-item">JavaScript 技术精进</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/categories/%E4%B8%AA%E4%BA%BA%E6%88%90%E9%95%BF/"><span class="level-start"><span class="level-item">个人成长</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/categories/%E5%87%9D%E6%9E%9C%E5%BC%80%E6%BA%90/"><span class="level-start"><span class="level-item">凝果开源</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/categories/%E5%BC%80%E6%BA%90%E7%88%B1%E5%A5%BD%E8%80%85%E6%9C%88%E5%88%8A/"><span class="level-start"><span class="level-item">开源爱好者月刊</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/blog/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-04T00:00:00.000Z">2020-06-04</time></p><p class="title is-6"><a class="link-muted" href="/blog/2020/06/04/00E-from-node-to-deno/">从 Node 到 Deno：探索各大主流库替代方案</a></p><p class="is-uppercase"><a class="link-muted" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/">Deno 钻研之术</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-06-01T00:00:00.000Z">2020-06-01</time></p><p class="title is-6"><a class="link-muted" href="/blog/2020/06/01/00D-osm-005/">开源爱好者月刊：第 5 期（202005）</a></p><p class="is-uppercase"><a class="link-muted" href="/blog/categories/%E5%BC%80%E6%BA%90%E7%88%B1%E5%A5%BD%E8%80%85%E6%9C%88%E5%88%8A/">开源爱好者月刊</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-25T00:00:00.000Z">2020-05-25</time></p><p class="title is-6"><a class="link-muted" href="/blog/2020/05/25/00C-deno-websockets-preact/">Deno + WebSockets 打造聊天室应用</a></p><p class="is-uppercase"><a class="link-muted" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/">Deno 钻研之术</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-22T00:00:00.000Z">2020-05-22</time></p><p class="title is-6"><a class="link-muted" href="/blog/2020/05/22/00B-awesome-deno-cn/">Awesome Deno 中文资源全图谱</a></p><p class="is-uppercase"><a class="link-muted" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/">Deno 钻研之术</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-18T00:00:00.000Z">2020-05-18</time></p><p class="title is-6"><a class="link-muted" href="/blog/2020/05/18/00A-deno-handbook-typescript/">Deno 入门手册：附大量 TypeScript 代码实例</a></p><p class="is-uppercase"><a class="link-muted" href="/blog/categories/Deno-%E9%92%BB%E7%A0%94%E4%B9%8B%E6%9C%AF/">Deno 钻研之术</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/blog/tags/Awesome/"><span class="tag">Awesome</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Deno/"><span class="tag">Deno</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Github/"><span class="tag">Github</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/JavaScript/"><span class="tag">JavaScript</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Node/"><span class="tag">Node</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/React/"><span class="tag">React</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/Rome/"><span class="tag">Rome</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/TypeScript/"><span class="tag">TypeScript</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/WebSockets/"><span class="tag">WebSockets</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%87%9D%E6%9E%9C%E5%BC%80%E6%BA%90/"><span class="tag">凝果开源</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%89%8D%E7%AB%AF/"><span class="tag">前端</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%AE%89%E8%A3%85/"><span class="tag">安装</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%B7%A5%E5%85%B7%E9%93%BE/"><span class="tag">工具链</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%BC%80%E6%BA%90%E5%A5%B3%E6%80%A7/"><span class="tag">开源女性</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E5%BC%80%E6%BA%90%E7%88%B1%E5%A5%BD%E8%80%85%E6%9C%88%E5%88%8A/"><span class="tag">开源爱好者月刊</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E6%80%BB%E7%BB%93/"><span class="tag">总结</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E6%89%91%E5%85%8B%E7%89%8C/"><span class="tag">扑克牌</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E6%95%85%E4%BA%8B/"><span class="tag">故事</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E7%96%AB%E6%83%85/"><span class="tag">疫情</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/blog/tags/%E7%A8%8B%E5%BA%8F%E5%91%98/"><span class="tag">程序员</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blog/"><img src="/blog/img/logo.svg" alt="韩亦乐的个人网站" height="28"></a><p class="size-small"><span>&copy; 2020 Hylerrix Han</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/hylerrix"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://hylerrix.github.io/blog',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/blog/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/blog/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/blog/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blog/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>